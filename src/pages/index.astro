---
import BaseLayout from "../layouts/BaseLayout.astro";
import Navbar from "../components/Navbar.astro";
import { client, imageBuilder } from "../lib/sanity-client";
import PortableText from "../components/PortableText.astro";

const query =
  '*[_type == "profile" && name == "Jesper FÃ¸risdahl"][0] {name,bio,image}';
let data = await client.fetch(query);
---

<BaseLayout>
  <Navbar />
  <main class="max-w-[1600px] mx-auto">
    <div class="grid grid-cols-1 lg:grid-cols-2 md:grid-auto-rows">
      <div class="p-8">
        <PortableText value={data.bio} />
      </div>
      <picture class="rounded w-full p-8 order-1">
        <source type="image/webp" srcset={`
          ${imageBuilder.image(data.image).format('webp').width(1366).url()} 1366w,
          ${imageBuilder.image(data.image).format('webp').width(1024).url()} 1024w,
          ${imageBuilder.image(data.image).format('webp').width(768).url()} 768w,
          ${imageBuilder.image(data.image).format('webp').width(500).url()} 500w,
          ${imageBuilder.image(data.image).format('webp').width(200).url()} 200w,
        `}
        sizes="(max-width: 1600px) 1024px, (min-width: 1024px) 1024px, (min-width: 768px) 768px, 500px"
        />
        <source srcset={`
          ${imageBuilder.image(data.image).width(1366).url()} 1366w,
          ${imageBuilder.image(data.image).width(1024).url()} 1024w,
          ${imageBuilder.image(data.image).width(768).url()} 768w,
          ${imageBuilder.image(data.image).width(500).url()} 500w,
          ${imageBuilder.image(data.image).width(200).url()} 200w,
          `}
          sizes="(max-width: 1600px) 1024px, (min-width: 1024px) 1024px, (min-width: 768px) 768px, 500px"
        />
        <img
          class="rounded"
          src={imageBuilder.image(data.image).url()}
          width="1200"
          height="900"
          alt={data.image.alt}
        />
        <figcaption>{data.image.caption}</figcaption>
      </picture>
    </div>
  </main>
</BaseLayout>
